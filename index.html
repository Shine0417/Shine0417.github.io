<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phone Tracking app</title>
</head>
<body>    
    <div>
        <h3 >status: </h3>
        <h1 id="status" style="color: red;">Stopped</h1>
        <button id="start">Start</button>
        <button id="stop">Stop</button>
    </div>
    <script>
        const startCollect= document.getElementById('start');
        const stopCollect = document.getElementById('stop');
        const status = document.getElementById('status');
        var id = -1;
        var coordinate = window.localStorage.getItem("data");
        startCollect.addEventListener('click', () => {
            status.innerText = "Started";
            status.setAttribute("style", "color: green");
            if(coordinate == null)
                coordinate = [];
            id = navigator.geolocation.watchPosition(data => {
                console.log("data: " + data);
                // console.log(new Date());
                coordinate.push([data.coords.longitude, data.coords.latitude]);
                window.localStorage.setItem("data", JSON.stringify(coordinate));
            }, (error) => console.log(error))
            console.log("watch id: "+id);
        })

        stopCollect.addEventListener('click', () => {
            if(id != -1){
                navigator.geolocation.clearWatch(id);
                status.innerText = "Stopped";
                status.setAttribute("style", "color: red");
                id = -1;
            }
        })
    </script>
    
</body>
</html>
